<div class="card mb-3">
    <div class="card-body">
        <h3 class="card-title">Browse Topics</h3>
        <ul class="list-group">
            <li 
            class="
            list-group-item list-group-item-action 
            {% if not request.GET.q %}active{% endif %}
            " 
            aria-current="{% if not request.GET.q %}true{% else %}false{% endif %}
            "
            style="margin-bottom: 4px;"
            >
            {% if request.user.is_authenticated %}
                <a href="{% url 'home' %}">All</a>
            {% else %}
                <a href="{% url 'users:login' %}?next={% url 'home' %}">All</a>
            {% endif %}
            </li>
            {% for topic in topics|slice:":2" %}
            <li 
            class="
            list-group-item list-group-item-action 
            {% if request.GET.q == topic.name %}active{% endif %}
            " 
            aria-current="{% if request.GET.q == topic.name %}true{% else %}false{% endif %}">
                {% if request.user.is_authenticated %}
                    <a href="?q={{ topic.name }}">
                        {{ topic.name }}
                    </a>
                {% else %}
                    <a href="{% url 'users:login' %}?next={% url 'home' %}?q={{ topic.name }}">
                        {{ topic.name }}
                    </a>
                {% endif %}
            </li>
            {% endfor %}
            <!-- Updated: Container for additional topics -->
            {% if topics|length > 5 %}
            <li id="extra-topics" class="list-group-item extra-topics" style="display: none;">
                {% for topic in topics|slice:"5:" %}
                <div 
                class="
                list-group-item list-group-item-action 
                {% if request.GET.q == topic.name %}active{% endif %}
                " 
                aria-current="{% if request.GET.q == topic.name %}true{% else %}false{% endif %}">
                    {% if request.user.is_authenticated %}
                        <a href="?q={{ topic.name }}">
                            {{ topic.name }}
                        </a>
                    {% else %}
                        <a href="{% url 'users:login' %}?next={% url 'home' %}?q={{ topic.name }}">
                            {{ topic.name }}
                        </a>
                    {% endif %}
                </div>
                {% endfor %}
            </li>
            <!-- Updated: See More and See Less buttons -->
            <li class="list-group-item">
                <button id="see-more-topics" class="btn btn-primary btn-sm see-more-btn">See More</button>
                <button id="see-less-topics" class="btn btn-primary btn-sm see-less-btn" style="display: none;">See Less</button>
            </li>
            {% endif %}
        </ul>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const items = document.querySelectorAll('.list-group-item');

        items.forEach(item => {
            item.addEventListener('click', () => {
                items.forEach(i => i.classList.remove('.active'));
                item.classList.add('.active');
            });
        });

        // Updated: Toggle functionality for See More/See Less
        const seeMoreBtn = document.getElementById('see-more-topics');
        const seeLessBtn = document.getElementById('see-less-topics');
        const extraTopics = document.getElementById('extra-topics');

        if (seeMoreBtn && seeLessBtn && extraTopics) {
            seeMoreBtn.addEventListener('click', function() {
                extraTopics.style.display = 'block';
                seeMoreBtn.style.display = 'none';
                seeLessBtn.style.display = 'inline-block';
            });

            seeLessBtn.addEventListener('click', function() {
                extraTopics.style.display = 'none';
                seeMoreBtn.style.display = 'inline-block';
                seeLessBtn.style.display = 'none';
            });
        }
    });
</script>